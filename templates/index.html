<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ app_title }} — Review & Annotate</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="title">{{ app_title }}</div>
    <div class="project-selector">
      <select id="projectSwitcher"></select>
      <button id="btnNewProject" title="Create a new project">+</button>
    </div>
    <div class="actions">
      <a class="btn" href="/">Go to Catalog</a>
      <a class="btn" href="/raw_review">New Image Review</a>
      <a class="btn" id="btnReviewMode" href="/review">Review Mode ⚡</a>
      <button id="btnAddFromCatalog">Add From Catalog</button>
      <button id="btnDelete" title="Delete selected (D)">Delete Selected</button>
      <button id="btnImport" title="Import Pascal VOC zip">Import VOC</button>
      <input type="file" id="importFile" accept=".zip" style="display:none;" />
      <button id="btnImportImages" title="Import new images">Add New Images</button>
      <input type="file" id="importImagesFile" accept=".zip" style="display:none;" />
      <button id="btnExport" title="Export Pascal VOC (E)">Export VOC (annotated only)</button>
    </div>
  </header>

  <section class="controls">
    <div class="left">
      <label>Page Size
        <select id="pageSize">
          <option value="100">100</option>
          <option value="150">150</option>
          <option value="200" selected>200</option>
          <option value="240">240</option>
          <option value="300">300</option>
          <option value="500">500</option>
        </select>
      </label>
      <label>Thumb
        <select id="thumbSize">
          <option value="96">96</option>
          <option value="112" selected>112</option>
          <option value="128">128</option>
          <option value="160">160</option>
          <option value="224">224</option>
        </select>
      </label>
      <label>Filter
        <input id="filterText" placeholder="filename contains..." />
      </label>
      <label>Class
        <select id="classFilter">
          <option>All Classes</option>
        </select>
      </label>
    </div>
    <div class="right">
      <button id="btnPrev" title="Previous (←)">Prev</button>
      <span id="pageInfo"></span>
      <button id="btnNext" title="Next (→)">Next</button>
    </div>
  </section>

  <footer class="foot">
    <div>Tips: Click to select. Shift-click selects a range. Press D to delete, A to toggle select-all on page, E to export. Click ✏️ to annotate an image.</div>
  </footer>

  <section id="grid" class="grid"></section>

  <script>
    window.appConfig = { pageSize: {{ page_size|int }} };
  </script>
  <script src="/static/utils.js" defer></script>
  <script src="/static/main.js" defer></script>

  <div id="exportModal" class="modal-underlay" style="display: none;">
    <div class="modal-content">
      <div id="exportSpinner" class="spinner-overlay" style="display: none;">
        <div class="spinner"></div>
      </div>
      <h2>Advanced Export Options</h2>
      <div class="form-group">
        <label>Classes to Export</label>
        <div id="exportClassList" class="classlist"></div>
      </div>
      <div class="form-group">
        <label>Class Remapping (optional)</label>
        <div id="exportRemap" class="remap-grid">
          <span><i>e.g. `cat, kitten`</i></span>
          <span>→</span>
          <span>`cat`</span>
        </div>
        <button id="addRemapRow" type="button">Add Row</button>
      </div>
      <div class="form-group">
        <label>Null Images</label>
        <select id="nullHandling">
          <option value="unclassified" selected>Export as unclassified (no labels)</option>
          <option value="exclude">Exclude from export</option>
        </select>
      </div>
      <div class="actions">
        <button id="runExport" class="primary">Export</button>
        <button id="cancelExport" type="button">Cancel</button>
      </div>
    </div>
  </div>

  <div id="newProjectModal" class="modal-underlay" style="display: none;">
    <div class="modal-content">
      <h2>Create New Project</h2>
      <div class="form-group">
        <label for="newProjectName">Project Name</label>
        <input type="text" id="newProjectName" placeholder="Alphanumeric, no spaces" />
      </div>
      <div class="actions">
        <button id="runCreateProject" class="primary">Create & Switch</button>
        <button id="cancelCreateProject" type="button">Cancel</button>
      </div>
    </div>
  </div>
</body>
</html>
